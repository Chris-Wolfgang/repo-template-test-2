# PR Trigger Workflow
# This workflow runs from the main branch and calls the pr.yaml workflow
# This ensures that the workflow definition from main is always used, even for PRs from feature branches
#
# SECURITY NOTE:
# - Uses pull_request_target to run workflow from main branch (not PR branch)
# - This prevents malicious workflow modifications in untrusted PR branches
# - The called pr.yaml explicitly checks out the PR's code using the provided SHA
# - Permissions are restricted to read-only access to repository contents
# - No paths-ignore filter to ensure all PRs are validated

name: PR Validation (Main Branch)

permissions:
  contents: read

on:
  pull_request_target:  # Runs from base branch (main), not from PR branch
    branches:
      - main
      - develop

jobs:
  call-pr-workflow:
    name: "Execute PR Checks from Main Branch"
    uses: ./.github/workflows/pr.yaml
    permissions:
      contents: read  # Explicitly limit permissions for the called workflow
    with:
      pr-sha: ${{ github.event.pull_request.head.sha }}
